version: "3.7"

networks:
  default:
  traefik_traefik:
    external: true

services:
  jellyfin:
    image: jellyfin/jellyfin:10.8.6
    container_name: jellyfin_jellyfin
    labels:
      - traefik.enable=true
      - traefik.http.routers.jellyfin.rule=Host(`jellyfin.{{ domain }}`)
      - traefik.http.services.jellyfin.loadbalancer.server.port=8096
    restart: unless-stopped
    env_file:
      - .env.jellyfin
    networks:
      - default
      - traefik_traefik
    volumes:
      - {{ base_volume_path }}/jellyfin/config:/config
      - {{ base_volume_path }}/jellyfin/cache:/cache
      - {{ media_volume_path }}/Plex/media:/data/media:ro
      - {{ media_volume_path }}/other_videos:/data/other_videos:ro
    tmpfs:
      - /tmp/transcodes
    devices:
      - /dev/dri:/dev/dri
